<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Data4thought: data science blog</title><link href="https://nkthiebaut.github.io/" rel="alternate"></link><link href="https://nkthiebaut.github.io/feeds/all-en.atom.xml" rel="self"></link><id>https://nkthiebaut.github.io/</id><updated>2018-08-19T22:00:00+02:00</updated><entry><title>Few-shot learning in Natural Language Processing: learning many-classes classification from few examples</title><link href="https://nkthiebaut.github.io/fewshot_learning_nlp.html" rel="alternate"></link><published>2018-08-19T22:00:00+02:00</published><updated>2018-08-19T22:00:00+02:00</updated><author><name>Nicolas Thiebaut</name></author><id>tag:nkthiebaut.github.io,2018-08-19:/fewshot_learning_nlp.html</id><summary type="html">
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Few-shot-learning-on-textual-data-with-siamese-neural-networks"&gt;Few-shot learning on textual data with siamese neural networks&lt;a class="anchor-link" href="#Few-shot-learning-on-textual-data-with-siamese-neural-networks"&gt;¶&lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;If you're doing machine learning and meet a classification problem with many categories and few examples per category, it is usually thought that you're in trouble. Unfortunately, acquiring new data to solve this issue is not always easy or even doable.&lt;/p&gt;
&lt;p&gt;This problem of learning with only a few examples per category is called "few-shot learning", and "one-shot learning" in the extreme case of only one example per class (yes, you can even do this and &lt;a href="https://www.cs.cmu.edu/~rsalakhu/papers/oneshot1.pdf"&gt;obtain decent results&lt;/a&gt;</summary><content type="html">&lt;style type="text/css"&gt;/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell &gt; div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area &gt; div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area &gt; div.highlight &gt; pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the &lt;head&gt; if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev &lt;Maniac@SoftwareManiacs.Org&gt;
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell &gt; div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
&lt;/style&gt;
&lt;style type="text/css"&gt;.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */&lt;/style&gt;
&lt;style type="text/css"&gt;
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
&lt;/style&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Few-shot-learning-on-textual-data-with-siamese-neural-networks"&gt;Few-shot learning on textual data with siamese neural networks&lt;a class="anchor-link" href="#Few-shot-learning-on-textual-data-with-siamese-neural-networks"&gt;¶&lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;If you're doing machine learning and meet a classification problem with many categories and few examples per category, it is usually thought that you're in trouble. Unfortunately, acquiring new data to solve this issue is not always easy or even doable.&lt;/p&gt;
&lt;p&gt;This problem of learning with only a few examples per category is called "few-shot learning", and "one-shot learning" in the extreme case of only one example per class (yes, you can even do this and &lt;a href="https://www.cs.cmu.edu/~rsalakhu/papers/oneshot1.pdf"&gt;obtain decent results&lt;/a&gt;!).&lt;/p&gt;
&lt;p&gt;Most of the machine learning research on one-shot learning involves images, but some &lt;a href="https://arxiv.org/abs/1710.10280"&gt;recent research papers&lt;/a&gt; address the same problem in the Natural Language Processing (NLP) realm.&lt;/p&gt;
&lt;p&gt;In this blog post, I will use siamese neural network to tackle few-shot learning , following a &lt;a href="https://www.cs.cmu.edu/~rsalakhu/papers/oneshot1.pdf"&gt;method that was originally applied to images&lt;/a&gt; and that is nicely explained &lt;a href="https://sorenbouma.github.io/blog/oneshot/"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;A nice example of a few-shot learning problem in NLP is job title classification. If you want to group job titles in different categories or "occupations" (e.g. gather "Programmer" and "Software engineer" in an occupation, and " in another one), then unless you have hundreds of job titles examples per occupation you are facing a few-shot learning problem. The U.S government provides such a job title taxonomy: the &lt;a href="https://www.bls.gov/soc/"&gt;Standard Occupational Classification&lt;/a&gt;. I'll use it as a toy dataset understand how few-shot learning with siamese neural networks works.&lt;/p&gt;
&lt;p&gt;Let's start by downloading the taxonomy and check what's in there.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;io&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;StringIO&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;requests&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;

&lt;span class="c1"&gt;# Download the Standard Occupation Classification&lt;/span&gt;
&lt;span class="n"&gt;file_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'https://www.onetcenter.org/dl_files/database/db_20_1_text/Sample&lt;/span&gt;&lt;span class="si"&gt;%20o&lt;/span&gt;&lt;span class="s1"&gt;f%20Reported%20Titles.txt'&lt;/span&gt;
&lt;span class="n"&gt;csv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;StringIO&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file_url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Load it in a pandas DataFrame and drop a useless column&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_csv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;csv&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sep&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="se"&gt;\t&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Shown in My Next Move'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[3]:&lt;/div&gt;
&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped=""&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
&lt;thead&gt;
&lt;tr style="text-align: right;"&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;O*NET-SOC Code&lt;/th&gt;
&lt;th&gt;Reported Job Title&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;th&gt;0&lt;/th&gt;
&lt;td&gt;11-1011.00&lt;/td&gt;
&lt;td&gt;Chief Diversity Officer (CDO)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;1&lt;/th&gt;
&lt;td&gt;11-1011.00&lt;/td&gt;
&lt;td&gt;Chief Executive Officer (CEO)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;2&lt;/th&gt;
&lt;td&gt;11-1011.00&lt;/td&gt;
&lt;td&gt;Chief Financial Officer (CFO)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;3&lt;/th&gt;
&lt;td&gt;11-1011.00&lt;/td&gt;
&lt;td&gt;Chief Nursing Officer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;4&lt;/th&gt;
&lt;td&gt;11-1011.00&lt;/td&gt;
&lt;td&gt;Chief Operating Officer (COO)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The downloaded file contains job categories codes (first column) and samples of job titles that belong to those categories. To get categories description type the occupation code &lt;a href="https://www.onetonline.org/help/online/search"&gt;here&lt;/a&gt;. For instance, the first occupation (11-1011.00) is called "Chief Executives" as one can guess from the corresponding job titles examples.&lt;/p&gt;
&lt;p&gt;Let's investigate a bit:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [65]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nunique&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;  &lt;span class="c1"&gt;# Count the number of different modalities in each column&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[65]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;O*NET-SOC Code         956
Reported Job Title    7174
dtype: int64&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;So we have 956 categories ("occupations") for 7174 examples, i.e. 7.5 examples per category on average. We are definitely in the few-shot learning setting.&lt;/p&gt;
&lt;p&gt;Before proceeding with modelling let's create a train and test sets.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [27]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.model_selection&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;train_test_split&lt;/span&gt;

&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'Reported Job Title'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'Reported Job Title'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lower&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;occupations&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'O*NET-SOC Code'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unique&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;occupations_train&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;occupations_test&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;train_test_split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;occupations&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;test_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;df_train&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'O*NET-SOC Code'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;isin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;occupations_train&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="n"&gt;df_test&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'O*NET-SOC Code'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;isin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;occupations_test&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="n"&gt;x_train&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_train&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df_train&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'Reported Job Title'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;df_train&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'O*NET-SOC Code'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;x_test&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_test&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df_test&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'Reported Job Title'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;df_test&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'O*NET-SOC Code'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Building-a-baseline"&gt;Building a baseline&lt;a class="anchor-link" href="#Building-a-baseline"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Before experimenting with fancy models, let's establish a strong baseline. We can start by using word embeddings to get a vector representation of each job title, and use a nearest neighbor classifier that is a less likely to overfit than tree-based models or parametric classifiers.&lt;/p&gt;
&lt;p&gt;To get the representation of a sentence from pre-trained word embeddings I'll use &lt;a href="https://github.com/nkthiebaut/zeugma"&gt;Zeugma&lt;/a&gt;, an NLP python library I've written that provides pre-trained word embeddings in the form &lt;a href="http://scikit-learn.org/stable/modules/pipeline.html"&gt;scikit-learn transformers&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [28]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;zeugma&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;EmbeddingTransformer&lt;/span&gt;

&lt;span class="c1"&gt;# We'll use the GloVe pre-trained embeddings, using the sum of the word embeddings&lt;/span&gt;
&lt;span class="c1"&gt;# of a job title as the embedding vector&lt;/span&gt;
&lt;span class="n"&gt;embedding&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;EmbeddingTransformer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'glove'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;aggregation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'sum'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [62]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.pipeline&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;make_pipeline&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.neighbors&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;KNeighborsClassifier&lt;/span&gt;

&lt;span class="c1"&gt;# Our model is a nearest neighbor classifier, the input of which is the sum of the &lt;/span&gt;
&lt;span class="c1"&gt;# embeddings of words in the job title.&lt;/span&gt;
&lt;span class="n"&gt;clf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;KNeighborsClassifier&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n_neighbors&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;baseline&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;make_pipeline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;embedding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;clf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [64]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Note that the model is fitted directly on the test set,&lt;/span&gt;
&lt;span class="c1"&gt;# because it has not adjustable parameters&lt;/span&gt;
&lt;span class="n"&gt;baseline&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x_test&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_test&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Test accuracy (baseline): &lt;/span&gt;&lt;span class="si"&gt;{:.2f}&lt;/span&gt;&lt;span class="s1"&gt; %'&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;baseline&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;score&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x_test&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_test&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Test accuracy (baseline): 87.18 %
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Not bad for a simple baseline model, and it may seem hard to beat with a deep learning model due to the high chances of overfitting with such a small datasets, but here come siamese networks to the rescue.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Few-shot-learning-with-siamese-neural-networks"&gt;Few-shot learning with siamese neural networks&lt;a class="anchor-link" href="#Few-shot-learning-with-siamese-neural-networks"&gt;¶&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The nearest neighbor model of the previous section is preforming quite well despite its simplicity, because it uses word embeddings learnt on the twitter dataset. This is the basic principle of &lt;a href="https://en.wikipedia.org/wiki/Transfer_learning"&gt;transfer learning&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Nevertheless, the embedding space used to determine nearest neighbors knows nothing about job titles in particular. There must be a way to learn an embedding space in which jobs belonging to the same occupation category are closer. This is where siamese networks come into play.&lt;/p&gt;
&lt;p&gt;The main idea of siamese networks is to learn such a representation by training a model to discriminate between pairs of examples that are in the same category, and pairs of examples that come from different categories.&lt;/p&gt;
&lt;p&gt;We'll learn about it the next blog article, stay tuned!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;
</content><category term="python"></category><category term="machine learning"></category><category term="deep learning"></category><category term="natural language processing"></category></entry><entry><title>LIME of words: interpreting Recurrent Neural Networks predictions</title><link href="https://nkthiebaut.github.io/deep-lime.html" rel="alternate"></link><published>2017-09-12T16:00:00+02:00</published><updated>2017-09-12T16:00:00+02:00</updated><author><name>Nicolas Thiebaut</name></author><id>tag:nkthiebaut.github.io,2017-09-12:/deep-lime.html</id><summary type="html">
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Interpreting-recurrent-neural-networks-with-LIME"&gt;Interpreting recurrent neural networks with LIME&lt;a class="anchor-link" href="#Interpreting-recurrent-neural-networks-with-LIME"&gt;¶&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;This is the second part of my blog post on the LIME interpretation model. For a reminder of what LIME is and its purpose, please read the &lt;a href="https://nkthiebaut.github.io/lime-of-words.html"&gt;first part&lt;/a&gt;. This second part is a quick application of the same algorithm to a deep learning (LSTM) model, while the first part was focused on explaining the predictions of a random forest.&lt;/p&gt;</summary><content type="html">&lt;style type="text/css"&gt;/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell &gt; div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area &gt; div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area &gt; div.highlight &gt; pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the &lt;head&gt; if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev &lt;Maniac@SoftwareManiacs.Org&gt;
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell &gt; div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
&lt;/style&gt;
&lt;style type="text/css"&gt;.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */&lt;/style&gt;
&lt;style type="text/css"&gt;
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
&lt;/style&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Interpreting-recurrent-neural-networks-with-LIME"&gt;Interpreting recurrent neural networks with LIME&lt;a class="anchor-link" href="#Interpreting-recurrent-neural-networks-with-LIME"&gt;¶&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;This is the second part of my blog post on the LIME interpretation model. For a reminder of what LIME is and its purpose, please read the &lt;a href="https://nkthiebaut.github.io/lime-of-words.html"&gt;first part&lt;/a&gt;. This second part is a quick application of the same algorithm to a deep learning (LSTM) model, while the first part was focused on explaining the predictions of a random forest.&lt;/p&gt;
&lt;p&gt;As a reminder we use movie reviews from &lt;a href="www.imdb.com"&gt;IMDB&lt;/a&gt; to predict the sentiment of the review (positive if the author of the comment gave 7 stars and above, negative elsewise).&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_csv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'../content/labeledTrainData.tsv'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sep&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="se"&gt;\t&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[1]:&lt;/div&gt;
&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style&gt;
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
&lt;thead&gt;
&lt;tr style="text-align: right;"&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;id&lt;/th&gt;
&lt;th&gt;sentiment&lt;/th&gt;
&lt;th&gt;review&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;th&gt;0&lt;/th&gt;
&lt;td&gt;5814_8&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;With all this stuff going down at the moment w...&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;1&lt;/th&gt;
&lt;td&gt;2381_9&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;\The Classic War of the Worlds\" by Timothy Hi...&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;2&lt;/th&gt;
&lt;td&gt;7759_3&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;The film starts with a manager (Nicholas Bell)...&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;3&lt;/th&gt;
&lt;td&gt;3630_4&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;It must be assumed that those who praised this...&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;4&lt;/th&gt;
&lt;td&gt;9495_8&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;Superbly trashy and wondrously unpretentious 8...&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.model_selection&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;train_test_split&lt;/span&gt;

&lt;span class="n"&gt;texts_train&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;texts_test&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_train&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_test&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; \
    &lt;span class="n"&gt;train_test_split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"review"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'sentiment'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;random_state&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;42&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Modelling-with-LSTM"&gt;Modelling with LSTM&lt;a class="anchor-link" href="#Modelling-with-LSTM"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In this example of LIME usage I use a Long Short-Term Memory (LSTM) network to predict the sentiment (positive or negative) associated with an IMDB movie review. LSTM is a specific kind of recurrent neural network that is well explained rather informally &lt;a href="http://www.wildml.com/2015/10/recurrent-neural-network-tutorial-part-4-implementing-a-grulstm-rnn-with-python-and-theano/"&gt;here&lt;/a&gt;, and more in a more detailed way &lt;a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/"&gt;there&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Preprocessing"&gt;Preprocessing&lt;a class="anchor-link" href="#Preprocessing"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In order to preprocess text in a convenient way that can be easily handled by the LIME library, I build a scikit-learn &lt;a href="http://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html"&gt;Pipeline&lt;/a&gt; object that handles a list of texts as input and returns the prediction of a neural network, thanks to the &lt;a href="https://keras.io"&gt;Keras&lt;/a&gt; scikit-learn API.&lt;/p&gt;
&lt;p&gt;Pipelines combine various Transformer objects to transform data from raw input to a predicted output. In our case we have to define 2 custom Transformers to translate input text in a form that can be handled by our LSTM. The first transformer takes a list of texts as input and outputs a list of indices lists, for instance &lt;code&gt;[["the cute cat"], ["the dog"]] -&gt; [[1, 2, 3], [1, 4]].&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;The second transformer harmonizes input lengths to a given &lt;em&gt;maxlen&lt;/em&gt;, padding with zeros if the sequence is too short, and cropping the beginning of the sequence if it is too long.&lt;/p&gt;
&lt;p&gt;After application of those 2 Transformers we end up with a matrix of shape &lt;em&gt;(n_samples, maxlen)&lt;/em&gt;, readily usable by Keras models.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;vocab_size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;20000&lt;/span&gt;  &lt;span class="c1"&gt;# Max number of different word, i.e. model input dimension&lt;/span&gt;
&lt;span class="n"&gt;maxlen&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;80&lt;/span&gt;  &lt;span class="c1"&gt;# Max number of words kept at the end of each text&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;keras.preprocessing.text&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Tokenizer&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;keras.preprocessing.sequence&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;pad_sequences&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.pipeline&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TransformerMixin&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.base&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;BaseEstimator&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TextsToSequences&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Tokenizer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;BaseEstimator&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;TransformerMixin&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;""" Sklearn transformer to convert texts to indices list &lt;/span&gt;
&lt;span class="sd"&gt;    (e.g. [["the cute cat"], ["the dog"]] -&gt; [[1, 2, 3], [1, 4]])"""&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;fit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;texts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fit_on_texts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;texts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;
    
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;transform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;texts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;texts_to_sequences&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;texts&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        
&lt;span class="n"&gt;sequencer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TextsToSequences&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_words&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;vocab_size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stderr output_text"&gt;
&lt;pre&gt;Using TensorFlow backend.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Padder&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BaseEstimator&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;TransformerMixin&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;""" Pad and crop uneven lists to the same length. &lt;/span&gt;
&lt;span class="sd"&gt;    Only the end of lists longernthan the maxlen attribute are&lt;/span&gt;
&lt;span class="sd"&gt;    kept, and lists shorter than maxlen are left-padded with zeros&lt;/span&gt;
&lt;span class="sd"&gt;    &lt;/span&gt;
&lt;span class="sd"&gt;    Attributes&lt;/span&gt;
&lt;span class="sd"&gt;    ----------&lt;/span&gt;
&lt;span class="sd"&gt;    maxlen: int&lt;/span&gt;
&lt;span class="sd"&gt;        sizes of sequences after padding&lt;/span&gt;
&lt;span class="sd"&gt;    max_index: int&lt;/span&gt;
&lt;span class="sd"&gt;        maximum index known by the Padder, if a higher index is met during &lt;/span&gt;
&lt;span class="sd"&gt;        transform it is transformed to a 0&lt;/span&gt;
&lt;span class="sd"&gt;    """&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;maxlen&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;maxlen&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;maxlen&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max_index&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;
        
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;fit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max_index&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pad_sequences&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;maxlen&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;maxlen&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;
    
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;transform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;X&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pad_sequences&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;maxlen&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;maxlen&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt; &lt;span class="o"&gt;&gt;&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max_index&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;

&lt;span class="n"&gt;padder&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Padder&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;maxlen&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="LSTM-construction-and-training"&gt;LSTM construction and training&lt;a class="anchor-link" href="#LSTM-construction-and-training"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;We now simply have to chain our preprocessing Transformers and our LSTM model. Here I have chosen a rather standard network with 128 hidden units, and dropout rate of 50 %. I only train during 2 epochs as I don't monitor overffiting here, but a more performant model could be trained with more epochs and early stopping.&lt;/p&gt;
&lt;p&gt;Note that we use a &lt;a href="https://en.wikipedia.org/wiki/Bidirectional_recurrent_neural_networks"&gt;Bidirectional LSTM&lt;/a&gt; here, that uses information from both preceeding and following words to compute a word representation when scanning a sentence, but this is a detail for our purpose.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [18]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;keras.models&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Sequential&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;keras.layers&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Dense&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Embedding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Bidirectional&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;LSTM&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;keras.wrappers.scikit_learn&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;KerasClassifier&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.pipeline&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;make_pipeline&lt;/span&gt;

&lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;64&lt;/span&gt;
&lt;span class="n"&gt;max_features&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;vocab_size&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;create_model&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_features&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;""" Model creation function: returns a compiled Bidirectional LSTM"""&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Sequential&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Embedding&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_features&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Bidirectional&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LSTM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dropout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;recurrent_dropout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Dense&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;activation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'sigmoid'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'adam'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'binary_crossentropy'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;metrics&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'accuracy'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;model&lt;/span&gt;

&lt;span class="c1"&gt;# Use Keras Scikit-learn wrapper to instantiate a LSTM with all methods&lt;/span&gt;
&lt;span class="c1"&gt;# required by Scikit-learn for the last step of a Pipeline&lt;/span&gt;
&lt;span class="n"&gt;sklearn_lstm&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;KerasClassifier&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;build_fn&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;create_model&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;epochs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
                               &lt;span class="n"&gt;max_features&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;max_features&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;verbose&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Build the Scikit-learn pipeline&lt;/span&gt;
&lt;span class="n"&gt;pipeline&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;make_pipeline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sequencer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;padder&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sklearn_lstm&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;pipeline&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;texts_train&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_train&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Epoch 1/2
18750/18750 [==============================] - 259s - loss: 0.5450 - acc: 0.7294      
Epoch 2/2
18750/18750 [==============================] - 276s - loss: 0.3682 - acc: 0.8447     
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [19]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;metrics&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Computing predictions on test set...'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;y_preds&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pipeline&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;predict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;texts_test&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Test accuracy: &lt;/span&gt;&lt;span class="si"&gt;{:.2f}&lt;/span&gt;&lt;span class="s1"&gt; %'&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;metrics&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;accuracy_score&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y_preds&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_test&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Computing predictions on test set...
6250/6250 [==============================] - 24s     
Test accuracy: 82.90 %
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Performances are similar to the &lt;em&gt;TF-IDF + Random forest&lt;/em&gt; model of the first part of this post (82% accuracy). Hence we do not have enough data to leverage the modelling power of our LSTM, but this example is enough to illustrate the usage of LIME for a deep learning model. As before we choose an example and compute feature importance with the LIME package.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [45]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# We choose a sample from test set&lt;/span&gt;
&lt;span class="n"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;11&lt;/span&gt;
&lt;span class="n"&gt;text_sample&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;texts_test&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;class_names&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'negative'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'positive'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Sample &lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;: last 80 words (only part used by the model)'&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'-'&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;" "&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text_sample&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;:]))&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'-'&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Probability(positive) ='&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pipeline&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;predict_proba&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;text_sample&lt;/span&gt;&lt;span class="p"&gt;])[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'True class: &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;class_names&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y_test&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Sample 11: last 80 words (only part used by the model)
--------------------------------------------------
Who? What? Where? When? Why? The acting was terrible. Very robotic, rehearsed. I have seen all of the actors in this film in better roles. The screenplay was very elementary. By the end of this film, the story line was tied up. And Jeane Claude LaMarre should be tied up, too. So that he never attempts to write/direct another film.
--------------------------------------------------
1/1 [==============================] - 0s
Probability(positive) = 0.112901
True class: negative
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [46]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;seaborn&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;sns&lt;/span&gt;
&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;collections&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;OrderedDict&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;lime.lime_text&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;LimeTextExplainer&lt;/span&gt;

&lt;span class="n"&gt;explainer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;LimeTextExplainer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;class_names&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;class_names&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;explanation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;explainer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;explain_instance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text_sample&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pipeline&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;predict_proba&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_features&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;weights&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;OrderedDict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;explanation&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_list&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;lime_weights&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;'words'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;weights&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;()),&lt;/span&gt; &lt;span class="s1"&gt;'weights'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;weights&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;())})&lt;/span&gt;

&lt;span class="n"&gt;sns&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;barplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"words"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"weights"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;lime_weights&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xticks&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rotation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;45&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Sample &lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt; features weights given by LIME'&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;5000/5000 [==============================] - 20s      128/5000 [..............................] - ETA: 19s
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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
YII=
" /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;As for the first model, we get an ensemble of 10 explanation features that seem make sense. Note the fact that "write" has a large negative weight, probably because it is preceeded by "he never attempts to" in our example (and the LSTM model is aware of the ordering of words!).&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Conclusion"&gt;Conclusion&lt;a class="anchor-link" href="#Conclusion"&gt;¶&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We have used the LIME interpretation to provide explanations for the individual predictions of a random forest model working on TF-IDF features, and a recurrent neural network. In both cases LIME outputs important features that make sense.&lt;/p&gt;
&lt;p&gt;While we were having a way to obtain weights for single predictions with the random forest, LIME could also provide a sign that allows for a deeper understanding of the model output. In the case of the reccurent neural network, LIME is even more important as it is harder than for the random forest to extract the relevant weights to determine the most important features.&lt;/p&gt;
&lt;p&gt;According to my experiments, LIME appears as an interesting method to interpret a model output. Its model agnostic aspect helps to compare different models within the same framework, and may become an important tool to assess models relevance, in addition to the standard performance metrics that are sensitive to datasets (ubiquitous :) leaks from the future, or can be misleading when evaluation metrics definition is tricky.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;
</content><category term="python"></category><category term="machine learning"></category><category term="deep learning"></category></entry><entry><title>LIME of words: how to interpret your machine learning model predictions</title><link href="https://nkthiebaut.github.io/lime-of-words.html" rel="alternate"></link><published>2017-08-07T16:00:00+02:00</published><updated>2017-08-07T16:00:00+02:00</updated><author><name>Nicolas Thiebaut</name></author><id>tag:nkthiebaut.github.io,2017-08-07:/lime-of-words.html</id><summary type="html">
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Experiments-with-the-LIME-interpretation-model"&gt;Experiments with the LIME interpretation model&lt;a class="anchor-link" href="#Experiments-with-the-LIME-interpretation-model"&gt;¶&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;In this blog post I will share experiments on the LIME (Local Interpretable Model-agnostic Explanations) interpretation model. LIME was introduced in 2016 by Marco Ribeiro and his collaborators in a paper called &lt;a href="https://arxiv.org/abs/1602.04938"&gt;“Why Should I Trust You?” Explaining the Predictions of Any Classifier&lt;/a&gt;. The purpose of this method is to explain a model prediction for a specific sample in a human-interpretable way.&lt;/p&gt;</summary><content type="html">&lt;style type="text/css"&gt;/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell &gt; div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area &gt; div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area &gt; div.highlight &gt; pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the &lt;head&gt; if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev &lt;Maniac@SoftwareManiacs.Org&gt;
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell &gt; div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
&lt;/style&gt;
&lt;style type="text/css"&gt;.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */&lt;/style&gt;
&lt;style type="text/css"&gt;
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
&lt;/style&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Experiments-with-the-LIME-interpretation-model"&gt;Experiments with the LIME interpretation model&lt;a class="anchor-link" href="#Experiments-with-the-LIME-interpretation-model"&gt;¶&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;In this blog post I will share experiments on the LIME (Local Interpretable Model-agnostic Explanations) interpretation model. LIME was introduced in 2016 by Marco Ribeiro and his collaborators in a paper called &lt;a href="https://arxiv.org/abs/1602.04938"&gt;“Why Should I Trust You?” Explaining the Predictions of Any Classifier&lt;/a&gt;. The purpose of this method is to explain a model prediction for a specific sample in a human-interpretable way.&lt;/p&gt;
&lt;p&gt;It brings a way to investigate a model predictions beyond the sole classification or regression standard metrics. It also may provide explanations to individuals when they are refused a loan or job on the basis of a scoring model, or in other critical situations like the one listed &lt;a href="https://weaponsofmathdestructionbook.com"&gt;in this very good book&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In order to set the playground I first build a quick model on the &lt;a href="www.imdb.com"&gt;IMDB&lt;/a&gt; sentiment analysis dataset, which contains movie reviews with an associated sentiment (0 for negative, 1 for positive). Data was downloaded &lt;a href="https://www.kaggle.com/c/word2vec-nlp-tutorial/download/labeledTrainData.tsv.zip"&gt;on kaggle&lt;/a&gt;, let's have a look at it.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_csv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'./labeledTrainData.tsv'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sep&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="se"&gt;\t&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[1]:&lt;/div&gt;
&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style&gt;
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
&lt;thead&gt;
&lt;tr style="text-align: right;"&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;id&lt;/th&gt;
&lt;th&gt;sentiment&lt;/th&gt;
&lt;th&gt;review&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;th&gt;0&lt;/th&gt;
&lt;td&gt;5814_8&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;With all this stuff going down at the moment w...&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;1&lt;/th&gt;
&lt;td&gt;2381_9&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;\The Classic War of the Worlds\" by Timothy Hi...&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;2&lt;/th&gt;
&lt;td&gt;7759_3&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;The film starts with a manager (Nicholas Bell)...&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;3&lt;/th&gt;
&lt;td&gt;3630_4&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;It must be assumed that those who praised this...&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;4&lt;/th&gt;
&lt;td&gt;9495_8&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;Superbly trashy and wondrously unpretentious 8...&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Text-preprocessing"&gt;Text preprocessing&lt;a class="anchor-link" href="#Text-preprocessing"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Here I simply replace rare words with an "oov" (out-of-vocabulary) tag. This step is crucial as rare words (tipically less than 10 occurences) do not appear often enough for the model to learn pattern with it, and even worse they increase the vector space representation dimension dramatically with most text vectorization method (such as bag-of-words or TF-IDF).&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;collections&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;defaultdict&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.model_selection&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;train_test_split&lt;/span&gt;

&lt;span class="n"&gt;texts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lower&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'review'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'sentiment'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;

&lt;span class="c1"&gt;# 1) Compute word frequencies&lt;/span&gt;
&lt;span class="n"&gt;all_tokens&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;token&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;texts&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;token&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;()]&lt;/span&gt; 
&lt;span class="n"&gt;frequencies&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;defaultdict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;w&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;all_tokens&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;frequencies&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Vocabulary size before rare words tagging:'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;all_tokens&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;

&lt;span class="c1"&gt;# 2) Replace words occuring less than 10 times in the corpus with an &lt;/span&gt;
&lt;span class="c1"&gt;# out-of-vocabulary tag &lt;/span&gt;
&lt;span class="n"&gt;texts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;' '&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;w&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;frequencies&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&gt;&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="s1"&gt;'&lt;oov&gt;'&lt;/span&gt; 
                   &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;w&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;()])&lt;/span&gt;
         &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;texts&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Vocabulary size after rare words tagging:'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
      &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;token&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;texts&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;token&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;()])))&lt;/span&gt;

&lt;span class="c1"&gt;# 3) Split train and test sets (should be done before rare words &lt;/span&gt;
&lt;span class="c1"&gt;# tagging in real world applications)&lt;/span&gt;
&lt;span class="n"&gt;texts_train&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;texts_test&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_train&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_test&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; \
    &lt;span class="n"&gt;train_test_split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;texts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;random_state&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;42&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Vocabulary size before rare words tagging: 257663
Vocabulary size after rare words tagging: 25341
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Building-a-simple-sentiment-prediction-pipeline"&gt;Building a simple sentiment prediction pipeline&lt;a class="anchor-link" href="#Building-a-simple-sentiment-prediction-pipeline"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Here I build a simple data transformation pipeline for text classification: a &lt;a href="https://en.wikipedia.org/wiki/Tf–idf"&gt;TF-IDF&lt;/a&gt; vectorizer followed by a &lt;a href="https://en.wikipedia.org/wiki/Random_forest"&gt;random forest classifier&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This classification pipeline is prettty standard but it's output prediction may already be hard enough to interpret in order to highlight LIME's usefulness.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.feature_extraction.text&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TfidfVectorizer&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.pipeline&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;make_pipeline&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.ensemble&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;RandomForestClassifier&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;metrics&lt;/span&gt;

&lt;span class="n"&gt;vectorizer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TfidfVectorizer&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;classifier&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;RandomForestClassifier&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n_estimators&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;max_depth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;pipeline&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;make_pipeline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vectorizer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;classifier&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;pipeline&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;texts_train&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_train&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;y_preds&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pipeline&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;predict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;texts_test&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Accuracy: &lt;/span&gt;&lt;span class="si"&gt;{:.2f}&lt;/span&gt;&lt;span class="s1"&gt; %'&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;metrics&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;accuracy_score&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y_preds&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_test&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'F1-score: &lt;/span&gt;&lt;span class="si"&gt;{:.2f}&lt;/span&gt;&lt;span class="s1"&gt; %'&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;metrics&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;f1_score&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y_preds&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_test&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Accuracy: 82.58 %
F1-score: 83.19 %
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Analysis:-what-has-the-model-learnt?"&gt;Analysis: what has the model learnt?&lt;a class="anchor-link" href="#Analysis:-what-has-the-model-learnt?"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;A F1-score of 80% is already enjoyable for some classification tasks, but &lt;strong&gt;we have no idea if the classifier has learnt useful features yet&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;For instance an additional HTML tag may have been added to the positive examples by the IMDB database system, in which case our classifier would have a nice score but would only learn to recognize this artificial tag presence. This situation happens quite often in data science as some variable "from the future" sometimes leak in your dataset.&lt;/p&gt;
&lt;p&gt;To avoid such ungeneralizable model training, one has to investigate the model prediction in addition to computing  its performance on a test set.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Feature-importance"&gt;Feature importance&lt;a class="anchor-link" href="#Feature-importance"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;A standard way to understand the predictions of a trained random forest classifier is to compute feature (Gini) importance. Feature importance in trees is computed as the (normalized) mean Gini impurity reduction brought by the features. In a word it describes how well the feature splits classes in your trees.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;seaborn&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;sns&lt;/span&gt;
&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline

&lt;span class="c1"&gt;# Create a dictionary with most important features&lt;/span&gt;
&lt;span class="n"&gt;importances&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pipeline&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;named_steps&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'randomforestclassifier'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;feature_importances_&lt;/span&gt;
&lt;span class="n"&gt;top_indices&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argsort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;importances&lt;/span&gt;&lt;span class="p"&gt;)[::&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;features_names&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vectorizer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_feature_names&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;words_importance&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;'most_important_words'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;features_names&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;top_indices&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                                 &lt;span class="s1"&gt;'importance'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;importances&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;top_indices&lt;/span&gt;&lt;span class="p"&gt;]})&lt;/span&gt;

&lt;span class="n"&gt;sns&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;barplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"most_important_words"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"importance"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;words_importance&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xticks&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rotation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;45&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Global features importance: top words'&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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
gg==
" /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;So now we have the most important words on average on the training set. The most important words make sense, but&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;We &lt;strong&gt;don't know if a word contributes positively or negatively&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;The feature importance attribute is &lt;strong&gt;specific to tree-based models&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;If we &lt;strong&gt;don't undestand specific predictions&lt;/strong&gt;, we cannot investigate the model if we doubt a given prediction&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For the last point there is a work-around: we can compute the model importance of the words that are present in a specific text.&lt;/p&gt;
&lt;p&gt;Here is an example:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# We choose a sample from test set&lt;/span&gt;
&lt;span class="n"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;text_sample&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;texts_test&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;class_names&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'negative'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'positive'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text_sample&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'-'&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Probability(positive) ='&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pipeline&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;predict_proba&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;text_sample&lt;/span&gt;&lt;span class="p"&gt;])[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'True class: &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;class_names&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y_test&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;this film pulls you in from the &lt;oov&gt; because it grabs our attention by &lt;oov&gt; yeah, that this story is opening with a cliché  a &lt;oov&gt; /&gt;&lt;br /&gt;in hands other than &lt;oov&gt; i wouldn't have given it an 8 as this material has been done over and over again: the great reunion of a once famous, pick one please, team, army &lt;oov&gt; theatre group, singers, &lt;oov&gt; /&gt;&lt;br /&gt;but this movie never &lt;oov&gt; to cheap &lt;oov&gt; and when you think it is going to it &lt;oov&gt; off in another direction. a case in point is the flowers that are sent by an admirer to &lt;oov&gt; /&gt;&lt;br /&gt;the band members are an interesting group and ride above the clichés too. one is in jail, one has found religion, one is an &lt;oov&gt; and one has sunk into &lt;oov&gt; but the &lt;oov&gt; de &lt;oov&gt; rediscovered by &lt;oov&gt; &lt;oov&gt; by her &lt;oov&gt; interest, carries us along and makes us overlook the sometimes simplistic nature of the plot.&lt;br /&gt;&lt;br /&gt;the cast are a who's who of talent, leslie caron, the incomparable &lt;oov&gt; cleo &lt;oov&gt; with her amazing high notes, a last performance from joan &lt;oov&gt; &lt;oov&gt; &lt;oov&gt; a cute as a button flirtatious ian holm having a ball, and olympia dukakis as a &lt;oov&gt; &lt;oov&gt; living in the &lt;oov&gt; of scotland with her &lt;oov&gt; and her &lt;oov&gt; the closing scene is standard &lt;oov&gt; fare, the &lt;oov&gt; children of the star converted to fun-loving &lt;oov&gt; the old lovers &lt;oov&gt; the youngsters swept up in the old &lt;oov&gt; music. life should be this simple. but i would watch it again, and intend to, with my own &lt;oov&gt; for in the right hands, sometimes one just loves these &lt;oov&gt; old clichés. 8 out of 10.
--------------------------------------------------
Probability(positive) = 0.582517738446
True class: positive
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;sample_importances&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vectorizer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;transform&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;text_sample&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toarray&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;importances&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flatten&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;sample_top_indices&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argsort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sample_importances&lt;/span&gt;&lt;span class="p"&gt;)[::&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;sample_words_importance&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'most_important_words'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vectorizer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_feature_names&lt;/span&gt;&lt;span class="p"&gt;())[&lt;/span&gt;&lt;span class="n"&gt;sample_top_indices&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="s1"&gt;'importance'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;sample_importances&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sample_top_indices&lt;/span&gt;&lt;span class="p"&gt;]})&lt;/span&gt;

&lt;span class="n"&gt;sns&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;barplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"most_important_words"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"importance"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;sample_words_importance&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xticks&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rotation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;45&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Sample &lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt; features importance: top words'&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZEAAAEsCAYAAAACdY78AAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAAIABJREFUeJzt3Xu8Z3O9x/HXnhkalzEGg9KNg09yv4SRcSmXiHBIHcql
RIUculCkm5LcuiDRGSI5iSa33O8ziBAGvWso4USbBuNuZvb54/Pd/Gz78ps1e/323rPfz8djHrN/
v/Vb6/tZv8v6fNf3+13f1dbR0YGZmVkVIwY6ADMzG7qcRMzMrDInETMzq8xJxMzMKnMSMTOzypxE
zMysslEDHYDVIyI2BI4GliQrC48AX5J0XwvK7gDGS3pyLtdrA84Apkk6rofX/BT4EPArSYdXiG15
4DhJO8/tuvMiItYDDpO0S4vLHQtMlvSBVpbbm4i4Ethtbr8frRYRSwHtktoGOpbBzElkPhQRbwEu
AbaSdGd57hPAZRGxvKTZAxpgNyJiFeBkYENgWi8v3Q94p6RHKxb1LiAqrluZpD8CLU0gxThg/QEo
tzdbDnQA1n+cROZPCwOLA4s2PHcO8CwwspwpnEgesMcAbcA+kqZGxJnAi8D7gGWB84B2YPvyeB9J
15bXdQCrAOOBK4EvSHq1MZCI+DTwefJs6CngAEl/7ibm/cmzkH/0tFMRcVOJ9bKI+DzwEHAS8E5g
AeB/JX2vvPZrwI7AaGAR4EvARcDPgeUi4goyIU2TtGhZ592djyNiL+DTZd1nJG3e075ExMbACcDI
8p4cLemCLrFvBpwkabX+eI8jYiJwLPlZvwIcIenyrnGX4heKiD8B6wJ7lv1eEFgC+L6kn5b1dgLm
ACuVbe4haVpELAucCrynLD9V0o/LWc6PgNXL+38N8GVJsyLi2wCSjuzyPpxR/rwuIrYFFiuf4ZJl
X4+XdFZ5v44FHgNWKO/XXpIe6LK9u0qZV0fEx4EzgXGSXoyI04G7yO/+ycBapYzLgK+VOF8GLgTW
BHYnv0vfBV4Abm8oZ1ngLGCp8tSlkr6OuU9kfiRpBvAV4PKIeCgizgb2Bq6W9AqwAfA2YIKk9wK/
AA5r2MTawARgPeBg4DlJG5EHjMbXrQlsAby3/NuvMY6I2JQ8aE2UtDbwA+C3PcR8gKSz+9ivieXP
zSXdBJwNTJK0Llnb3iIido2Id5W4NpW0BnA48O1yBrYP8KCkrXsrq1gV2KwkkN725VvACSWOTwHN
NB1Vfo8jYkngfOCgsn97Ar8sTXVviJv83F+UtBawEPAZYNuyDx8r+9FpU+BASasBU4Evl+dPAf4i
6T0l5n0jYkWyInJH2e+1yQPsIZDJo2sCKc/vXf7cHPgnmdh/UvZjG+B7ETGhvGYdMqmsQVYwuvt+
TCabNyn/zwAmRsQI4MPkZ/RjMumvXt7vNclKBWQyvVhSkE2+k4Cdyz493FDOZ4CHJK0DTARWKkl0
2HMSmU9JOgFYBvgC+WM9FLgrIsZKugU4gjwgHUc2szSetVws6VVJjwPPA5eX5x8ka6+dzpT0nKSX
yVpa1wPzh4EVgZtLTfgHwBIRsQTzKCIWIQ963ynbvpWsRa4l6WHywLp7RHwf+GyX/WvWPZKeLX/3
ti/nASdHxDlkbf9rTWx7Xt7jDYDpkv4AUPq5pgKbdRP3ayQ9B2wHfDgivkMm18b35Y6GZsI7G+LY
AjitbOMZSatJml62tV95P+4gE/nqTex7p5WB0ZJ+W7b9f8AFvJ4U7i6VBciD+9olgTaaTCYfyIP7
CWRz2QZkZeHxsvwkSR3lfTy1YR2AzjI2Bu6VdH95/LOG11wO7BwRvycrS4dJegZzEpkfRcT7I+LL
kmZKukTSV8ja6Rxgy4j4MHBpefmF5I+qsfPw5S6bfJXuzWr4ewTQta9lJHC2pLVKTXgdsiY4Y653
6s1GkjFv1LD9Dcma7DrAzWRTyZXAMbxx/zp1dHl+wS7Ln2tmXyT9jDx4XkUe5O9popY6L+9xd7/b
EWSTUte4XxMRbwf+RPYLTSErEo1ebPi78b2ZVR53bmeFiFiMfE8+2vCebAAc0MN+dKev/Wjc97by
7w3fMUn3AgtGxEeA6cDFwFbAR8iE1F05jWXA6+9X1+/Da+VLuh1Ynkym7wZui4iNet614cNJZP7U
DhxR2uo7vZVsJ7+XrKldLOmnZLvvjuQBYW59LCLeEhGjyZr/xV2WXwn8V0S8tTz+LNluPs9KTftW
SvNJRCxO1sZ3ADYB/ljOxm7gjfs3i9cPIE+TB6D3lsc79VJkj/sSETcDa0s6E9iX7I8aN4+72Km7
9/jWLDbWL+WvSu7z9d2sP4vsB2sjk147cJSkK8gzCSKir8/+arJZrHO01zVkv8kVwMER0VYGc1xE
c0lkNvkZCHglIv6zbPttwM5kMgZYKyLWKH/vC0yV9HQ325tMVhSuLP1tY8n+jc4kcgWwf0Oc+zaU
0egmYNWIWLM83qtzQTmj/bqk3wEHAfeRZ1LDnpPIfEjSX8gD5/dKn8j9ZJPLvpJEnnlsGhH3ALeQ
TSjLl3bkufEC+cO7t/x/RuPCcqA6BriqlLUb8J+S+mvq6N2ADSPiXuAPwLmSzgHOBZYq+30HWdNc
IiLGkD/+2RFxGznQ4CtkR/3tNNS2u+pjX74CfLt08l4HfEvS3/tpH9/0HpehsR8FflL2/VfA3uVz
7+qfZNPUA2SF4VFAJdZ3kkllxT5iOABYpez3VHLgwB1kU2lnxeSe8v8PACLi252d6934LXkmFOT3
9KCy7avJvqvryuseB75b9nFH4JM9bG8y2enfmRiuAv4p6ZHy+AvA0iW+e8nk9d2uG5HUTn6u50TE
neSZR6cfkkltGvBH4G/k92zYa/NU8FZFGTnU4/UcNu+G83vcOJptoGOx3vlMxMzMKvOZiJmZVeYz
ETMzq8xJxMzMKnMSMTOzyobV3Fnt7TPdAWRmNpfGjx/T40zGPhMxM7PKnETMzKwyJxEzM6vMScTM
zCpzEjEzs8qcRMzMrDInETMzq8xJxMzMKnMSMTOzyobVFetvcP6FrStrlx1aV5aZWQv5TMTMzCpz
EjEzs8qcRMzMrDInETMzq8xJxMzMKnMSMTOzypxEzMysMicRMzOrzEnEzMwqcxIxM7PKnETMzKwy
JxEzM6vMScTMzCpzEjEzs8pqmwo+IkYApwBrAi8D+0ia3rB8e+BIYBYwSdLpTaxzIiBJp5bHnwH2
K9s4StIlde2PmZm9WZ1nIjsCoyVNAA4Dju9cEBELACcCWwGbAvtGxDI9rRMR4yPiMuAjDdtYFvgC
8H5ga+DoiHhLjftjZmZd1JlENgYuB5B0K7Bew7JVgOmSZkh6BZgCbNLLOosC3wTObtjG+sBUSS9L
egaYDqxR296Ymdmb1Hlnw8WAZxoez46IUZJmdbNsJjC2l3X+BvwtIrbpZfud2+jRuHELM2rUSADa
53Jn5sX48WNaWJqZWevUmUSeBRqPniNKAulu2Rjg6T7W6Wv7ndvo0YwZLzQRdv9rb585IOWamfWH
3irCdTZnTQW2BYiIDYF7G5Y9AKwUEUtExIJkU9YtfazT1W3AxIgYHRFjySayaf2+F2Zm1qM6z0Qm
A1tGxM1AG7B3ROwGLCrptIg4BLiCTGSTJD0WEW9ap6eNS3o8In4M3FS2cbikl2rcHzMz66Kto6Nj
oGNomfb2ma/v7PkXtq7gXXZoXVlmZv1s/PgxbT0t88WGZmZWmZOImZlV5iRiZmaVOYmYmVllTiJm
ZlaZk4iZmVXmJGJmZpU5iZiZWWVOImZmVpmTiJmZVeYkYmZmlTmJmJlZZU4iZmZWmZOImZlV5iRi
ZmaVOYmYmVllTiJmZlaZk4iZmVXmJGJmZpU5iZiZWWVOImZmVpmTiJmZVeYkYmZmlTmJmJlZZU4i
ZmZWmZOImZlV5iRiZmaVOYmYmVllTiJmZlaZk4iZmVU2qq4NR8QI4BRgTeBlYB9J0xuWbw8cCcwC
Jkk6vad1ImJF4EygA5gG7C9pTkR8EdgNmAN8T9LkuvbHzMzerM4zkR2B0ZImAIcBx3cuiIgFgBOB
rYBNgX0jYple1jkBOELSRKAN2CEiFgcOAiaU7fywxn0xM7Nu1JlENgYuB5B0K7Bew7JVgOmSZkh6
BZgCbNLLOusCN5S/LwO2AJ4HHgYWKf/m1LgvZmbWjaabsyJiLPAf5MH6b5Ke6WOVxYDG18yOiFGS
ZnWzbCYwtqd1gDZJHV1eC/AIcD8wEji6r30YN25hRo0aCUB7Xy/uR+PHj2lhaWZmrdNnEomIbYBD
gfcCjwKvAu+IiAeA4yRd1sOqzwKNR88RJYF0t2wM8HRP60TEnG5euw3wVmD58vwVETFV0m097cuM
GS/0vKM1am+fOSDlmpn1h94qwr02Z0XEmWSfxf6Slpa0jqQNJL0N+AKwZUT8sofVpwLblu1sCNzb
sOwBYKWIWCIiFiSbsm7pZZ27ImKz8vc2wE3ADOBF4GVJL5GJZfHe9sfMzPpXX2cih0t6rLsFku4D
DomIt/ew7mQyydxMdobvHRG7AYtKOi0iDgGuIBPZJEmPRcSb1inb+iJwekk4DwDnS5odEVsAt5Yz
lSnAVc3uuJmZzbu2jo6Ovl8FRMT7gdWBM4ANJN1YZ2B1aG+f+frOnn9h6wreZYfWlWVm1s/Gjx/T
1tOypkZnRcRBwFHAIcCiwM8i4kv9E56ZmQ1VzQ7x3QvYGnhe0lPA+4BP1RWUmZkNDc0mkdnleo5O
LwGza4jHzMyGkGaTyA0RcRywSETsCFwEXFNfWGZmNhQ0m0S+DPwVuBvYA7gUcJ+Imdkw12wSWRgY
JemjwIHAMsCCtUVlZmZDQrNJ5Ffk1eGQ046MAM6uJSIzMxsymp07612SPgIg6VngiIj4U31hmZnZ
UNDsmUhHRKze+SAi3kPOoWVmZsNYs2ciXwKuiohHyelIlgI+WVtUZmY2JDSVRCRdHRHvJKc9eTWf
0su1RmZmZoNeU0kkIt4FHAAsQZ6JEBFI8lXrZmbDWLPNWeeR06/fRN7n3MzMrOkksoAkX1xoZmZv
0OzorCkRsX25n4eZmRnQ/JnILmSfCBHR+VyHpJF1BGVmZkNDs6Oz3lZ3IGZmNvQ0OzpraWB38oZU
bcBIYHlJe9QYm5mZDXLN9on8FlgL+ASwCPARYE5dQZmZ2dDQbBJZStKewMVkQtkMWLWuoMzMbGho
NonMKP8LWFPSM8AC9YRkZmZDRbOjs66NiN+Qc2hdGRHrkLfINTOzYaypMxFJhwOHSXoY2I08I9mp
zsDMzGzwayqJRMQFkh4EkHSHpBOBX9YamZmZDXq9NmdFxGRgTWC5iHioy3qP1BmYmZkNfn31iexJ
ztx7CvC5hudnAU/UFZSZmQ0NvSaRcivcZyNi2dIfYmZm9ppmh/g+ERETI+IttUZjZmZDSrNDfNcD
bgBPwGhmZq9rdgLG8XUHYmZmQ0+zEzAuDHwD+GBZ51rg65Ke72WdEWSH/JrAy8A+kqY3LN8eOJLs
pJ8k6fSe1omIFYEzybsqTgP2lzQnIrYpcbUBd5TnfedFM7MWabZP5CRy4sVPkSO2FgRO7WOdHYHR
kiYAhwHHdy6IiAWAE4GtgE2BfSNimV7WOQE4QtJEMmHsEBFjgGOB7SRtAPwdWKrJ/TEzs37QbJ/I
upLWbHh8QETc38c6GwOXA0i6NSLWa1i2CjBd0gyAiJgCbAJM6GGddSl9MsBlZPJ5AbgXOD4iVgB+
Lqm9yf0xM7N+0GwSGRERi0t6GiAiFieboXqzGPBMw+PZETFK0qxuls0Exva0DtDW0EzV+dqlgM3J
KeqfA26KiFsk/aWngMaNW5hRo3IsQCuzzfjxY1pYmplZ6zSbRE4Abo+Ii8jmpO2Bo/tY51mg8eg5
oiSQ7paNAZ7uaZ2ImNPNa58Cbpf0OEBE3EgmlB6TyIwZL/QRcj3a22cOSLlmZv2ht4pwsxMwnkFO
uPhQ+fefkib1sdpUYFuAiNiQbHrq9ACwUkQsERELkk1Zt/Syzl0RsVn5exvgJuBOYLWIWKqcrWwI
9NXEZmZm/ajZ0VkLAFuQo7NeBV6OiGl9jISaDGwZETeTZy97R8RuwKKSTouIQ4AryEQ2SdJjZa6u
N6xTtvVF4PSScB4Azpc0OyK+WrYBcJ6kaXOx72ZmNo/aOjr6HhEbEb8AFgLOJg/6ewCPSPrvesPr
X+3tM1/f2fMvbF3Bu+zQurLMzPrZ+PFj2npa1myfyAaS3tP5ICIuJq/XMDOzYazZ60QeKRf8dVoG
eKyGeMzMbAhp9kxkAeDuMgJqNnkNyP9FxLUAkj5QU3xmZjaINZtEvtHl8bH9HYiZmQ09zU7AeENE
rA6M6/L8jbVENYw8dd4nWlbWkrv6jsZm1r+aHeJ7Ljn1SGM/SAfgZiwzs2Gs2eastYBVJM2uMxgz
Mxtamh2d9QdgxT5fZWZmw0qzZyLXAvdFxP+REy+2kXc2XKG2yMzMbNBrNol8h+z/eLjGWMzMbIhp
Nom0Azf5roFmZtao2SRyN3BrRFwFvNL5pKRv1xKVmZkNCc0mkX+Uf5D9IWZmZk1fbPitugMxM7Oh
p9ckEhF3Slqn3FmwsT+kc3TWyFqjMzOzQa3XJCJpnfJ/s9eTmJnZMNJrcoiIoyNi8V6WLxERx/R/
WGZmNhT01SdyHvC7cpHhjcCj5MWG7yKvG3kbMKTubmhmZv2nr+asu4DNImJz4CPAdsAc4EHgZ5Ku
rT9EMzMbrJodnXUdcF3NsZiZ2RDT7FTwWwNHAUvQcJ2I584yMxvemr3Y8CfAIcA03jjU18zMhrFm
k8iTki6pNRIzMxtymk0iN0XECcDlwEudT/r2uGZmw1uzSWT98v/aDc/59rhmZsNcs6OzNq87EDMz
G3qaHZ21MfBlYFFydNZI4F2S3l1faGZmNtg1OyfWz4HfkUnnZOCvwOS6gjIzs6Gh2STyoqQzgOuB
GcBngE3rCsrMzIaGZjvWX4qIJQABG0q6NiIW6W2FiBgBnAKsCbwM7CNpesPy7YEjybm4Jkk6vad1
ImJF4EyyM38asL+kOQ3lXApcKOnUJvfHzMz6QbNnIicAvwYuBvaIiPuAP/axzo7AaEkTgMOA4zsX
RMQCwInAVuQZzb4RsUwv65wAHCFpItkns0NDOUcB45rcDzMz60dNJRFJvwG2kjQTWBf4BPDJPlbb
mLyuBEm3Aus1LFsFmC5phqRXgCnAJr2ssy5wQ/n7MmALgIjYhZwQ8vJm9sPMzPpXU0kkIsYBp0XE
tcBo4EBgbB+rLQY80/B4dkSM6mHZzLK9ntZpk9TR+NqIWA3YjWwSMzOzAdBsn8jpwJXkRYczgX8C
vwQ+3Ms6zwJjGh6PkDSrh2VjgKd7Wqfcnrfra/cAlgOuBd4NvBIRf5fU41nJuHELM2pU3tG3vZfA
+9v48WN6XPbUIInDzKyKZpPI8pJOi4jPleanwyPi7j7WmQpsD5wXERsC9zYsewBYqXTWP0c2ZR1H
dpx3t85dEbGZpOuBbYDrJP26c2MR8U3g8d4SCMCMGS80t7f9rL195oCU29VgicPMhpbeKqDNJpFZ
ETGWMoNvRKxE9kX0ZjKwZUTcTHaG7x0RuwGLloR0CHAF2aQ2SdJjEfGmdcq2vgicHhELkgno/Cbj
NjOzGrV1dPQ9s3tEfAg4GngH2Qk+AfiUpEvrDa9/tbfPfH1nz7+wdQXvskOPi5467xMtC2PJXX/Z
srLMbP4xfvyYtp6WNTvE9w7yzOJvwDuB35IjpszMbBhrtjnr98A9QOM9RXrMTGZmNjw0m0SQ9Ok6
AzEzs6Gn2STyu4jYhxxO2zlMF0n/qCUqMzMbEppNImPJaUiebHiuA1ih3yMyM7Mho9kksjOwtKQX
6wzGBsYNl3y0ZWVtut1vWlaWmdWv2dFZD+FJDs3MrItmz0Q6gPsjYhrwSueTknyPdTOzYazZJPLd
WqMwM7MhqakkIumGvl9lNm9Ovm6XlpW1/+aeOcesPzTbJ2JmZvYmTiJmZlaZk4iZmVXmJGJmZpU1
PXeW2XCw55QftaysX2x8UMvKMquLz0TMzKwyJxEzM6vMScTMzCpzEjEzs8qcRMzMrDInETMzq8xJ
xMzMKnMSMTOzypxEzMysMicRMzOrzEnEzMwq89xZZoPQ3jdc1LKyztj0Iy0ry+Y/PhMxM7PKnETM
zKwyN2eZWbf2vfHulpV12iZrtqws61+1JZGIGAGcAqwJvAzsI2l6w/LtgSOBWcAkSaf3tE5ErAic
CXQA04D9Jc2JiIOBj5dN/l7St+raHzMze7M6z0R2BEZLmhARGwLHAzsARMQCwInA+4DngakRcRHw
/h7WOQE4QtL1EXEqsENE3A3sDmwAzAGmRMRkSffUuE9m1mLnTXmhZWXtuvHCLStrflFnn8jGwOUA
km4F1mtYtgowXdIMSa8AU4BNellnXeCG8vdlwBbAI8CHJM2W1AEsALxU4/6YmVkXdZ6JLAY80/B4
dkSMkjSrm2UzgbE9rQO0lUTx2mslvQo8GRFtwLHAXZL+UtO+mJlZN+pMIs8CYxoejygJpLtlY4Cn
e1onIuZ081oiYjQwiUwsn+8roHHjFmbUqJEAtM/Vrsyb8ePH9LjsqUESx3CKAQZHHIMhBhgccfQe
Q+uaswbDezHU1JlEpgLbA+eV/o17G5Y9AKwUEUsAz5FNWceRHefdrXNXRGwm6XpgG+C6cgZyIXCt
pGOaCWjGjNZ9GRu1t88ckHK7GgxxDIYYYHDEMRhigMERx2CIAQZPHINNb8m1ziQyGdgyIm4G2oC9
I2I3YFFJp0XEIcAVZL/MJEmPRcSb1inb+iJwekQsSCag88mO+02Bt0TENuV1X5V0S437ZGZmDWpL
IpLmAJ/t8vSfG5ZfDFzcxDqUvo5Nuzw9GRjdL8GamfXi0QtfbFlZb99hoZaV1R98xbqZmVXmJGJm
ZpU5iZiZWWVOImZmVpknYDQzGyLmnNO666lH7L5yc6+rOQ4zM5uPOYmYmVllTiJmZlaZk4iZmVXm
JGJmZpU5iZiZWWVOImZmVpmTiJmZVeYkYmZmlTmJmJlZZU4iZmZWmZOImZlV5iRiZmaVOYmYmVll
TiJmZlaZk4iZmVXmJGJmZpU5iZiZWWVOImZmVpmTiJmZVeYkYmZmlTmJmJlZZU4iZmZWmZOImZlV
5iRiZmaVjaprwxExAjgFWBN4GdhH0vSG5dsDRwKzgEmSTu9pnYhYETgT6ACmAftLmhMRnwH2K9s4
StIlde2PmZm9WZ1nIjsCoyVNAA4Dju9cEBELACcCWwGbAvtGxDK9rHMCcISkiUAbsENELAt8AXg/
sDVwdES8pcb9MTOzLupMIhsDlwNIuhVYr2HZKsB0STMkvQJMATbpZZ11gRvK35cBWwDrA1MlvSzp
GWA6sEaN+2NmZl3U1pwFLAY80/B4dkSMkjSrm2UzgbE9rQO0Sero47Wdz/do/Pgxba89+Nwn5mpn
6jJ+/wsHOgR22fvygQ4BgG/uesVAh8DvdzpioEMA4JJddh/oEJi888YDHQIA++80ZqBDYPw+Ax8D
AP+97kBH8CZ1nok8CzS+8yNKAulu2Rjg6V7WmdPEazufNzOzFqkziUwFtgWIiA2BexuWPQCsFBFL
RMSCZFPWLb2sc1dEbFb+3ga4CbgNmBgRoyNiLNlENq3G/TEzsy7aOjo6+n5VBQ0jrdYgO8P3BtYB
FpV0WsPorBHk6KyTu1tH0p8jYmXgdGBBMgF9RtLsMjpr37KN70m6oJadMTOzbtWWRMzMbP7niw3N
zKwyJxEzM6vMScTM5luln9Vq5Dd4PhERbX2/ymx4iIj3AEia09drbd44icyliGiLiHEDHUeniFgh
IlZsuBhzIGMZdImsa010MMbYH1zjfl35jD8YEadGxN7lMoA6L6xuWuPn1MrvYkSMrqtcf/Hm3sHA
/0bE0gMdSLEQMCUiLo6IVVp9MCnX+pwKMBgSWaOIGNFZE42IrSBj7O8fUed7HhEj+3O7c1H+yDIh
6eIRsXpEjGl1shwsSSwiOme3uADYHviUpJckzRroRNL5fSwV0YWARVtU7krA+p1zC/b373RQfPBD
iaQTgEeA4wYykXQeJCTdB1wNTATGly/pyMbX1EnSv4FlImKLusuaG11+sN8DDo6Ij0P/JpKGA/hb
ge9FxDr9sd25Ua6ZeidwLnAgcCzwoVYlkob3eumI2CQiPtiKcruJY2TDAfJ54NvAgxFxMkDDjBkD
Fduc8pn8DpgE/KThIuo6zQC+Qb4Xu/X3xp1EmtT5gyxNWaOBtYGzyuzDrY5lRDkQjihX638L+DBw
bkRsRJkmps4zg4hYNCI6J/K5HFi+rrKqaPjB/p78nv8JWC8iPlmW90siKQfwpckDw33AuuWMcIl5
3XazSg37W8D3gZOBCeTnsXAryi/v9duAycCHgNMj4tBWlN2p/CZml9/EueQkrb8gWw4WjYhLI+LI
gZrpu8TWBnyFnG3jELLyd1BEvKOOMjvPDiU9CZxPThW1cH+fMTuJNKkcdEYDPwMukbQ6cD9wWpmW
viXK6fqc8gW5ADgL+LCkqcA+5A/5loio7aBeyv40Of3+l4F/APtFxKp1lVnRasCTkg4ja6V/B7aP
iI/CvCXZ0t7+7vJwO+Bm4Frgo8A3gT0qR91c+Y1NMx3kDA9rAd8hZ3EYC3yg5hjWKdMTARwDTJb0
NWBz8vvwkTrLb9RQabgAuJ08E/kQOfvFIcDfKLN+tyomeFMz3wHk9+JaSf8ssT5G3g+pv8vtPPMZ
ERFBVqI2BHYC9oqItUqT2jxzEulDl6z9KvmBd2b4Q4AVgUNb1R7ecOD7FXAl8D/AthFxYHm8KXCg
pL/VUX6pda8B/IW8/8tbyYP1W8mzswHT+BmUA8rTwGYR8X5JLwICliKbet41j8V9F/hXRGxM1izf
Th6s/gu4CFgt8r45/S4iliht/MuWA/XK5Pfhq8B15AF0O7KSU6eZZCXq58ATwF8jYkFJD5M3kat9
ZFSX313nZ/pH8oC9HvBx4FlJB0i6psWd2a81YUXEcpJ+Qp6x7lXOVFchzxr79ay18awM+A3wZeA0
4JPAnuRPFa/gAAAOnElEQVR34yygXyp9nvakFw1tvcsAq5P3LFmNPFX+A/Ak8Dngy5IerDmW16bD
j4jlyNrmD8iD2Ytk7e8G4Mi6alul3DPIBPIfwJ8kfbXUiv+brInW+j70EtuIhjO008jP5rfAOHLe
tZPIA8qB5d8pkm6sUE7n7QyIiAnkpKETJU2NiP2BF8jvxCck/aUfdq1r+fuQlZgp5H49QFZkfkX2
1X0SGEne6fPenrbTT7GMIJsLlydr+ncD1wPLAZ8HPtqK70NJDP9FJtB9gKfICsPDZJPWxyQ9Wncc
XWPqbHIm36NXgRcl7RoRx5PzCD5Ffg+vbfx9z2O54yW1l+R6UinzkHIMu4V8f+4Cxkj6x7yWB04i
PWo4KC1Fnna+APwZ+CvZfPNf5MioIyTVWuOLN44yWlTSc6Uje2OyCeUO4FLgEEl31hUDcDZwi6ST
ImIxspZzgqSBvxEIrx1MflQe3k7+YL5G1pJXJZPtP4EfA3vO7Y+onAH8uzRfbkBWJJYlDxKfAB4k
Z6G+pqYEsjGwC3mGtSowRdKPynfhS8DPJZ0fEQuVM6/alT7C5ckKzavk72M8WZn5a43lNlaqliX7
F04mm5snkJW9fYGvSrqyrjj6ipFsKfgj2ZH+J+AmSZ+JiKOAFYC9yo35+qO8bckzwAmSHoyIw0t5
N5blBwGP9vdEtW7O6kZDv8NSZA3752TH9f3A28j7nOxO1jbrTiCv9YFExCXAURFxHTnt/Yvkj/cq
4LgaE8jC5IHhCTJpIelZsiN5QC/mioh9GvqkDiKblQ6VdDY5SumHwHuAW8mmvuOAgyokkH2AXSLi
vWSl4iPAeeR9bLYl77i5oqSf1pFAikfIisORwJLAshGxpKSrgZ8Ae0TEmFYlEIByd9I7ge+R7/07
yMpMnQlkR7K5sC3yGqnHyeG8/wkcTlby/gR8rtUJpEsfyCLAQ2Ql77vk57ZRREwqfy8IHBP9MPS4
VDR/T36/LygDHZ4EvhERy0fEB8iKTvu8ltWVk0gX8frIp4XJN31L4JVyJnAR8C9gw4hYWNILNcfS
eIp7KnmgOphsvjiYvE/92cCXJF1SUwxvJ9txj6c0WUXESpFDBdcjfyQDabqkx8sIl3aylr57RCxe
3pOjyM71J8j36+OS7pmbAsoZwGpkBeJbwHmSPl22fSTZpv0+8uBVp8fKvz+TFZqngO0iYmlJl5L7
NrPmGLol6VpgV+Dg0mlci8j7Dz1UmupOAC6OiDVLH+DewBeA7ST9QdJtdcXRQ2yNfSArAAsAF5ID
HKaRTZ/3k9+fOZJ2AX4wr0OPG1sqyCbtWcA5wP+S/aSHlX+HV2nC7Yubsxo0NGEtR9Yy/0rWOK8G
jpV0e0QsCcyWVOtdFBvaVDv/P4I8SO1AJpQVAEm6vsYYxlK+jJJ+GRFHkiOPTiMPnN+s+0ysl9gW
kPRq+XsvYC+yHX5VsoP/IfLH+mx5TeU259IJfwHZjn092Yx1nKSnImI7YD9g11acAZTmoxXJs6xH
yCa0B4FzNIym+CiJ/VNk39xscrTg8+R38xhJtwxQXCPIfpiXgH+To/bGkZWMLYHPS7q6sW9tHst7
7ThBJqx/koNctiP7zXaR9K+IGCvpmd62VZWTSBclSUwiv4x/A35JtntPI/s/aq/dNCSzNrI2cTn5
RdyN7Pv4aXlu3zrjKc15PyWbJx4pz50PHAo83B8/gopxjWwYffJ74Ovk8MWJ5EVV65IH/OMlPdYP
5Y0ik8hKZHPe38mznsvKD3QRSc/PazlzGdMHyaa6e8nReE+1svyBVvrktiY/9wnkkOZngO9IumwA
4zqZbOa9mhwBdS45+GFB4N+Sbq6p3COB5SXtXY4bvyYTyUPA+sBLdVUy3Jz1ZmPJIZtPAvuTNb6n
yREntZ2md2roA2kj+zuek3QG+WW8hvzMziI7DOtOaM8BjwIbR8RbI+JDZEL99wAmkLaGBPJD8tqI
5ZXDJ+8gr1e4kzxznOcEAq9d6bwXOTxyNWBNsjN565LwW5pASkzXkM1HXxtuCQRe65O7jPyt/r78
21PSZdHaYbxd+zNeJCsZR5IDOJ4l+1AvqTGBjCUH+SxdmvY6yNF6ewLbS3qhzrNUn4l0ETm2fx2y
ffVssuP4ELKzttb2/y5nIGeTZx7nASdJmlJqXy8By6mm60C6iek95JDVpckmrEOUU60MqIjovKjs
KWDhMkppMbLv5iRJd9dU7rA+AxhsygF0GzKxXy7phhaWvYik50si2YQcVrweedb6dXK02BVkor+u
5ljGkcesFch+lz2Ar0u6qs5ywUmkRxHxdeDdZNPIrjWOuOla7ghy/P9TwAfJmu+vyaGLt3X2A7RS
GWSwGNBROqhbrrMJq+HxxiWx7l6eupXsaD24Bcl+FXL8/d/rLMeaU34zpwB/k3RMi8rcBXgvebYx
iaxsrkUOK16KPKDPAk6XdFGLYlqK7BfcAviFpP+Zl77AZg2K6ZEHqbPIawG+X+dwxW4cCiwg6Sul
hnM1OUpsIWDPiJhV95eiqzIKrdaRaL2JN16B+32yI/WHZfHL5NXJu5EXbtU+WkzSA3WXYXOlgzwz
vLoVhZXf5TPkHHq/AO6T9LWI2J7sQ9xT0jZlhGCtA3AaSXoyIk4iBxisERFrzO1IxCp8JjLIlC/i
BsCPlFee7kRpPpG03cBGN3BKE99Z5KwBi5OdqVuTnYZXABtJunXgIrSB1GWYa53ljNLr08p/kbwG
CWB/SS+UM5QTKVekD8SIucipiXYFftOKlgMnkUGmXO9wJDkabCY5xPjHZG37M8OpDT7eeFXyHuTU
M4eSV6FvRA5l3BlYUtLtAxaoDSslgZxPNjn/jhwh9hhwtqSZ5bqdfw1wjG9o/q2TR2cNMmUo7TFk
89FEslbzInmFcr9MjzAUxBvvDQE5tPZGcsjzjeRFf2NoSCCtHJVjw9ohQLukT0u6mJxy/wDgCyXB
PDmg0ZFTz7eqLPeJDEKSpgPTI+IuYDNyvqRPD9TVyK3WZRjveeQ4+2vIi6dWIy8w242cd+i1M5BW
9xXZsPUAMCbKXGrkMOPngbMGauj7QHISGdzuJzuRf9uKDuPBoMtp+OfJq7Fnk3OXjSFHia0G/FjS
lIGJ0oa5u8lm5o9HxEzgs+Rw2kcGNqyB4T4RGzTijdO5f4dswvs28Dg5989o4CZy9toXWzF80aw7
EbEisBV5CcA5yrnDhiUnERsUuswB9ANyBtS3k0njJPLOfV8Cfi1JAxep2eta2YE9WLlj3QZcl070
HwGLSPo8mTRWI2dmhbzRkhOIDSbDZtLLnjiJ2IBqvJAw8t7nqwPLRMQmZZaAE8gx90sPp1lqbWhw
c6qbs2wQKH0gvyVnTV6FnAfpGuA0STdGuZvjQMZoZt3zmYgNBt8A/ijpYPKOdH8FPgocWqaOcAIx
G6Q8xNcGg8uBt0fEOeTcQ/eTMwYf38q5h8xs7vlMxAaDu8hbvj5AVmx2Bj4r6VpfhW42uLlPxAaF
MmncUeS4+2+opnvGm1n/chKxQSMiFgLGlFvO+kJCsyHAScTMzCpzn4iZmVXmJGJmZpU5iZiZWWVO
ImZmVpmTiA1bEbF+RBzTx2vWi4ifD6aY+lj/uv6MZy7K3SsizhyIsm1g+Yp1G87eCyzT2wsk/RHY
pzXhAE3E1IfN+ikOs6Z4iK8NGRGxGXA4eW+R/wDOB54BdizPbQu8j7xocQTwELCfpCci4jhgS/Iu
iReSU87fAyxKTq/y3V7K/KakzSLievLq+i2AhYADyWnqVwVOlHRiRHwTWLnEtyTwM0nHlkkmfwh8
EOgAzpZ0TNn+D4CRwKPA2p0xAT8B/oe8r8rbyHvL7wFsCnwNeIGcsPJe8nbBx5WYbpO0QQ/780Vy
RuRDI2JLcuLLcZJmRcT9wObA8uX9GU3eL3w/SdPL/v+77O/HyBmXjwCeBR4GnpO0V9f3WtK3uovF
5g9uzrKhZgNgb/JA9jmgXdJ6ZEL4LPAzYEdJawBTgZMi4l3ANpLWBDYCVgJeAo4ELuopgfRE0urA
2eRBfmdgYtlWp9XIZLEusF9ErFNiewewBrA+sHNEfLi8fmXgA5J26BLTh4E/SZpQYp5ATotP2Y8D
yCTyTmBrSV8o8XWbQIpLS2yU/18A1omI5YGZwAzgf4EDyvt1KnBuw/r3SArgX2Ty26TENQagu/c6
Ikb3Eo8NcU4iNtRMk/SIpBfIWvI15fmHge3JWvjfy3OnkQfKx4AXI2IqcDBwhKSXKpZ/WUN5t0p6
QdLDwOINrzlX0nOSngEuAj5Q/p0paXaJ/RxeP5irvPYNJJ0LXBUR/00mrCXJs5TO9+HRco+VB8gJ
K/sk6c/A2IgYRya/k8gzm23IBLMyMEPS7eX1vwFWjIixZRN/KP9vBNws6QlJs4Bfluf78722IcBJ
xIaaV7o8ntXwd9fvcxswqhzkNgC+Th6Ib4mIlfuh/Fk9vKZrTLN6iq38/WJ3G4mIA4FjgXYyidxf
1oM8k+rU0fB8My4HdirrXcLrSeSSbuLsjHVkl1g7urx2FkA/v9c2BDiJ2PzkD8CGEfHu8nhf4LqI
WBu4AbhR0pfIg3GQB746BpfsFBELltr+9sCVwLXAnhExMiIWBnYHuhtJ1RjTlmSfyjnkQXstXj+Y
92R2RPS1T5eSfSpTyPu3vBdYWdKdgIAlI+J9ABGxK/CwpH932cYU8r1ervT3fKy8vqf32uZTTiI2
P3mCTByTI+I+cqTSZyXdBdwCTIuIO4G/k81St5EHwu/3cxwvkgfZW4CjJd1P9tU8CtxNds5fJGly
N+s2xvRD4Bsl5lOAm8lO795cCNzdRz/E9cBbgevLJJd3kQd+JL1MJoSTImIa2e/ysa4bkPQE2Yl/
dYn52fJ8T++1zac8OsusH5XRWUj65sBGYtYavk7Ehr2ImEj2OXRnW0n/18p4+kO56HBcN4tOlXRq
q+Ox+ZfPRMzMrDL3iZiZWWVOImZmVpmTiJmZVeYkYmZmlTmJmJlZZU4iZmZW2f8DGrpm1aWpmTsA
AAAASUVORK5CYII=
" /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Although the importance of "and" is hard to interpret, we see that some important words like great, amazing or cheap are indeed reasonable predictors for the sentiment of a review.&lt;/p&gt;
&lt;h3 id="Example-specific-analysis-with-LIME"&gt;Example specific analysis with LIME&lt;a class="anchor-link" href="#Example-specific-analysis-with-LIME"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In their article &lt;a href="https://arxiv.org/abs/1602.04938"&gt;“Why Should I Trust You?” Explaining the Predictions of Any Classifier&lt;/a&gt;, Marco Ribeiro and his collaborators introduce a new framework for machine learning models interpretation called LIME (Local Interpretable Model-agnostic Explanations).&lt;/p&gt;
&lt;p&gt;The purpose of LIME is to give an &lt;strong&gt;interpretable explanation for a given input sample prediction&lt;/strong&gt;, by locally approximating the model to be explained $f$ by an "explanation model" $g$ that is linear and has an interpretable domain. While your original model may operate on a complex vector space such as the TF-IDF representation of a text, or the HOG features of a picture, the explanation model's domain is a human interpretable one, such as a vector indicating the presence or absence of a few critical words in a text.&lt;/p&gt;
&lt;p&gt;LIME requires:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A &lt;strong&gt;mapping $x\rightarrow x'$ of the model input vector to an interpretable representation $\{0,1\}^{d'}$&lt;/strong&gt;. Here, while the original $x$ may be a complex vector in $\mathbb{R}^n$, the vector $x'$ just indicates the absence/ presence of basic features (words for text, pixels for pictures).&lt;/li&gt;
&lt;li&gt;A &lt;strong&gt;proximity measure function $\Pi_{x}$&lt;/strong&gt; measuring closeness to the sample $x$ under scrutiny. Usually a normal distribution over the distance (cosine distance for texts, L2-norm for pictures). &lt;/li&gt;
&lt;li&gt;A &lt;strong&gt;choice for the interpetable model $g$&lt;/strong&gt;. The first choice is a linear model (i.e. a linear regression for regression and a logistic regression for classification).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Technically, for a given sample $x\in\mathbb{R}^d$ to be explained we determine the corresponding interpretable vector $x'\in\{0,1\}^{d'}$ in the explanable feature space. We generate a set of $N$ artificial points $z_i'$ around it, by randomly cancelling coordinates or $x'$ (cancellations are chosen with a uniform distribution). We then fit a simple model $g$ (K-LASSO, i.e. a logistic regression with at most $K$ non-zero weights) that must reproduce the predictions of $f$ at best by minimizing the dissimilarity function&lt;/p&gt;
&lt;p&gt;$$\mathcal{L}(f, g, \Pi_x)= \sum_{z, z'} \Pi_x(z) \left[f(z) - g(z') \right]^2.$$ Note that the dissimilarity between the investigated mode $f$ and the interpretable model $g$ is 0 when $f$ and $g$ give the exact same predictions (which is why $\mathcal{L}$ minimization is also called "local fidelity maximization"). Also, dissimilarities are weighted by the $\Pi_x$ proximity between random samples $z$ and the original sample $x$ under investigation, such that predictions discrepancies far away from $x$ are less penalized.&lt;/p&gt;
&lt;p&gt;Let's take an example:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Suppose we investigate the prediction of a a sentiment classification model $f$ for the sentence "am quite happy", that is scored $0.7$ by $f$.&lt;/li&gt;
&lt;li&gt;Assume that due to our corpus the TF-IDF representation of the sentence "am quite happy" is $x=(0.2, 0.3, 0.1, 0, \dots)$, i.e. the first 3 coordinates correspond to the words "am", "quite" and "happy" in our corpus.&lt;/li&gt;
&lt;li&gt;The interpretable vector corresponding to $x$ is $x'=(1, 1, 1, 0, \dots)$. &lt;/li&gt;
&lt;li&gt;In order to define a neighborhood of $x'$ we generate some sparser samples $z_1'=(1, 0, 1, 0, \dots)$ and $z_2'=(1, 0, 0, 0, \dots)$ in the vicinity of $x'$.&lt;/li&gt;
&lt;li&gt;We compute the corresponding vectors in the original space: $z_1=(0.2, 0, 0.1, 0, \dots)$ and $z_2=(0.2, 0, 0, 0, \dots)$&lt;/li&gt;
&lt;li&gt;We compute the $d'$ weights of the explanation model $g$ by minimization of dissimilarity $\mathcal{L}$  with $f$ predictions (only $K$ of the $g$ function weights will be non-zero, were $K$ is an hyperparameter of LIME). For example if we obtain the following weights $(0, -0.5, 1.2, \dots)$, that means the presence of the word "quite" contributes negatively to the prediction, with weight $-0.5$, while the word "happy" contributes positively, with weight $1.2$.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Simple examples can be found on the &lt;a href="https://marcotcr.github.io/lime/tutorials/Lime%20-%20basic%20usage%2C%20two%20class%20case.html"&gt;Github repository of the project&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;For the example investigated above, LIME outputs the following important variables.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;collections&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;OrderedDict&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;lime.lime_text&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;LimeTextExplainer&lt;/span&gt;

&lt;span class="n"&gt;explainer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;LimeTextExplainer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;class_names&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;class_names&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;explanation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;explainer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;explain_instance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text_sample&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pipeline&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;predict_proba&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_features&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;weights&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;OrderedDict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;explanation&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_list&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;lime_weights&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;'words'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;weights&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;()),&lt;/span&gt; &lt;span class="s1"&gt;'weights'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;weights&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;())})&lt;/span&gt;

&lt;span class="n"&gt;sns&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;barplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"words"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"weights"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;lime_weights&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xticks&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rotation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;45&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Sample &lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt; features weights given by LIME'&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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
f1HTyjKz/sFXrJuZWWlOImZmVpqTiJmZleYkYmZmpTmJmJlZaU4iZmZWmpOImZmV5iRiZmalOYmY
mVlpTiJmZlaak4iZmZXmJGJmZqU5iZiZWWlOImZmVpqTiJmZleYkYmZmpTmJmJlZaU4iZmZWmpOI
mZmV5iRiZmalOYmYmVlpg5tZWEQMBM4AVgHeAnaXNKNi+ebAUcAcYJyksRXLvgQcK2lM8Xw1YBLw
j2KVMyVd1oz9MDOz1NQkAmwFDJG0dkSsBZwIbAkQEfMBJwNfBF4DpkbEtZL+ExGHADsXr7daHThJ
0olN3QMzM3tfs5uzRgM3Aki6B1ijYtlKwAxJMyW9DUwB1i2WPQ58s2pbqwObRsQdEXFORAxtbOhm
Zlat2UlkGPBKxfN3I2JwO8tmA8MBJF0JvFO1rXuBgyWtCzwB/KwhEZuZWbua3Zw1C6isMQyUNKed
ZUOBlzvY1gRJrcsnAKd2VviIEQsxePCg95+31BJxnYwc2XZF6cVeEIOZWVnNTiJTgc2B8UWfyLSK
ZY8CK0bEosCrZFPWCR1s66aI+KGke4H1gfs7K3zmzNdLB95dLS2ze6zs3hSDmfU9HZ2ANjuJTAC+
HhF3AQOAXSNiB2ARSWdFxIHATWQz2zhJz3awrb2BUyPiHeA5YI8Gx25mZlUGzJ07t6djaJqWltkf
3tkrrmle4dtu2ebLL47fqWkhLLb9RU0ry8zmHSNHDh3Q3jJfbGhmZqU5iZiZWWlOImZmVpqTiJmZ
leYkYmZmpTmJmJlZaU4iZmZWmpOImZmV5iRiZmalOYmYmVlpzZ47y3qp2ydt15Ry1tvs8qaUY2bN
4ZqImZmV5iRiZmalOYmYmVlpTiJmZlaak4iZmZXmJGJmZqU5iZiZWWlOImZmVpqTiJmZleYkYmZm
pTmJmJlZaZ3OnRUR8wE7AFsAKwLvATOAa4BLJb1Ta2ERMRA4A1gFeAvYXdKMiuWbA0cBc4BxksZW
LPsScKykMcXzFYDzgLnAdGBfSe/VGouZmXVfhzWRiNgUuAP4b/KAvRPwHWAcsDIwNSK26EJ5WwFD
JK0NHAacWFHWfMDJwIbAesAeETGqWHYIcDYwpGJbJwFHSFoHGABs2YU4zMysDjqriawIrNtGbeNR
4PqImB/YrwvljQZuBJB0T0SsUbFsJWCGpJkAETEFWBe4HHgc+CZwYcX6qwO3F49vIJPPhC7EYmZm
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
JmbmgeWyiwAAAABJRU5ErkJggg==
" /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;LIME managed to extract mostly the same important words as the model itself, without knowing anything about it! Moreover we now have rational numbers, allowing the human interpreter to understand if the contribution was negative or positive for each word of the sample. Finally, this technique can be replicated instantly for any model, so let's try with a neural network! (&lt;a href="https://nkthiebaut.github.io/deep-lime.html#deep-lime"&gt;next blog post&lt;/a&gt; :)&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;
</content><category term="python"></category><category term="machine learning"></category></entry></feed>