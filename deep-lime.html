
<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://nkthiebaut.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://nkthiebaut.github.io/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://nkthiebaut.github.io/theme/font-awesome/css/font-awesome.min.css">


    <link href="https://nkthiebaut.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Data4thought: data science blog Atom">


    <link rel="shortcut icon" href="https://nkthiebaut.github.io/images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="https://nkthiebaut.github.io/images/favicon.ico" type="image/x-icon">

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />


<meta name="author" content="Nicolas Thiebaut" />
<meta name="description" content="Interpreting recurrent neural networks with LIME¶This is the second part of my blog post on the LIME interpretation model. For a introduction on LIME and its purpose, please read the first part. This second part is an application of the same algorithm to a deep learning (LSTM) model, while the first part was focused on explaining the predictions of a random forest." />
<meta name="keywords" content="python, machine learning, deep learning">
<meta property="og:site_name" content="Data4thought: data science blog"/>
<meta property="og:title" content="LIME of words (part 2/2)"/>
<meta property="og:description" content="Interpreting recurrent neural networks with LIME¶This is the second part of my blog post on the LIME interpretation model. For a introduction on LIME and its purpose, please read the first part. This second part is an application of the same algorithm to a deep learning (LSTM) model, while the first part was focused on explaining the predictions of a random forest."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://nkthiebaut.github.io/deep-lime.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2017-09-12 16:00:00+02:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://nkthiebaut.github.io/author/nicolas-thiebaut.html">
<meta property="article:section" content="posts"/>
<meta property="article:tag" content="python"/>
<meta property="article:tag" content="machine learning"/>
<meta property="article:tag" content="deep learning"/>
<meta property="og:image" content="https://nkthiebaut.github.io/images/PhotoThiebaut.jpg">

  <title>Data4thought: data science blog &ndash; LIME of words (part 2/2)</title>

</head>
<body>
  <aside>
    <div>
      <a href="https://nkthiebaut.github.io">
        <img src="https://nkthiebaut.github.io/images/PhotoThiebaut.jpg" alt="Data4thought" title="Data4thought">
      </a>
      <h1><a href="https://nkthiebaut.github.io">Data4thought</a></h1>

<p>Nicolas Thiebaut's data science blog</p>
      <nav>
        <ul class="list">
          <li><a href="https://nkthiebaut.github.io/pages/about.html#about">About</a></li>
          <li><a href="https://nkthiebaut.github.io/pages/contact.html#contact">Contact</a></li>

        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/nthiebaut" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/nkthiebaut/" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/NicoThiebaut" target="_blank"><i class="fa fa-twitter"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="https://nkthiebaut.github.io">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="https://nkthiebaut.github.io/feeds/all.atom.xml">    Atom
</a>

    </nav>

<article class="single">
  <header>
    <h1 id="deep-lime">LIME of words (part 2/2)</h1>
    <p>
          Posted on Tue 12 September 2017 in <a href="https://nkthiebaut.github.io/category/posts.html">posts</a>


    </p>
  </header>


  <div>
    <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Interpreting-recurrent-neural-networks-with-LIME">Interpreting recurrent neural networks with LIME<a class="anchor-link" href="#Interpreting-recurrent-neural-networks-with-LIME">¶</a></h1><p>This is the second part of my blog post on the LIME interpretation model. For a introduction on LIME and its purpose, please read the <a href="https://nkthiebaut.github.io/lime-of-words.html">first part</a>. This second part is an application of the same algorithm to a deep learning (LSTM) model, while the first part was focused on explaining the predictions of a random forest.</p>
<p>As a reminder we use movie reviews from <a href="www.imdb.com">IMDB</a> to predict the sentiment of the review (positive if the author of the comment gave 7 stars and above, negative elsewise).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">B</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[6]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(4, 1)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'../content/labeledTrainData.tsv'</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[1]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>id</th>
<th>sentiment</th>
<th>review</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>5814_8</td>
<td>1</td>
<td>With all this stuff going down at the moment w...</td>
</tr>
<tr>
<th>1</th>
<td>2381_9</td>
<td>1</td>
<td>\The Classic War of the Worlds\" by Timothy Hi...</td>
</tr>
<tr>
<th>2</th>
<td>7759_3</td>
<td>0</td>
<td>The film starts with a manager (Nicholas Bell)...</td>
</tr>
<tr>
<th>3</th>
<td>3630_4</td>
<td>0</td>
<td>It must be assumed that those who praised this...</td>
</tr>
<tr>
<th>4</th>
<td>9495_8</td>
<td>1</td>
<td>Superbly trashy and wondrously unpretentious 8...</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>

<span class="n">texts_train</span><span class="p">,</span> <span class="n">texts_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> \
    <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">"review"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">'sentiment'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Modelling-with-LSTM">Modelling with LSTM<a class="anchor-link" href="#Modelling-with-LSTM">¶</a></h2><p>In this example of LIME usage I use a Long Short-Term Memory (LSTM) network to predict the sentiment (positive or negative) associated with an IMDB movie review. LSTM is a specific kind of recurrent neural network that is well explained rather informally <a href="http://www.wildml.com/2015/10/recurrent-neural-network-tutorial-part-4-implementing-a-grulstm-rnn-with-python-and-theano/">here</a>, and more in a more detailed way <a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/">there</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Preprocessing">Preprocessing<a class="anchor-link" href="#Preprocessing">¶</a></h3><p>In order to preprocess text in a convenient way that can be easily handled by the LIME library, I build a scikit-learn <a href="http://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html">Pipeline</a> object that handles a list of texts as input and returns the prediction of a neural network, thanks to the <a href="https://keras.io">Keras</a> scikit-learn API.</p>
<p>Pipelines combine various Transformer objects to transform data from raw input to a predicted output. In our case we have to define 2 custom Transformers to translate input text in a form that can be handled by our LSTM. The first transformer takes a list of texts as input and outputs a list of indices lists, for instance <code>[["the cute cat"], ["the dog"]] -> [[1, 2, 3], [1, 4]].</code></p>
<p>The second transformer harmonizes input lengths to a given <em>maxlen</em>, padding with zeros if the sequence is too short, and cropping the beginning of the sequence if it is too long.</p>
<p>After application of those 2 Transformers we end up with a matrix of shape <em>(n_samples, maxlen)</em>, readily usable by Keras models.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_size</span> <span class="o">=</span> <span class="mi">20000</span>  <span class="c1"># Max number of different word, i.e. model input dimension</span>
<span class="n">maxlen</span> <span class="o">=</span> <span class="mi">80</span>  <span class="c1"># Max number of words kept at the end of each text</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">keras.preprocessing.text</span> <span class="k">import</span> <span class="n">Tokenizer</span>
<span class="kn">from</span> <span class="nn">keras.preprocessing.sequence</span> <span class="k">import</span> <span class="n">pad_sequences</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="k">import</span> <span class="n">TransformerMixin</span>
<span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="k">import</span> <span class="n">BaseEstimator</span>

<span class="k">class</span> <span class="nc">TextsToSequences</span><span class="p">(</span><span class="n">Tokenizer</span><span class="p">,</span> <span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">TransformerMixin</span><span class="p">):</span>
    <span class="sd">""" Sklearn transformer to convert texts to indices list </span>
<span class="sd">    (e.g. [["the cute cat"], ["the dog"]] -> [[1, 2, 3], [1, 4]])"""</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_on_texts</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
    
    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">texts_to_sequences</span><span class="p">(</span><span class="n">texts</span><span class="p">))</span>
        
<span class="n">sequencer</span> <span class="o">=</span> <span class="n">TextsToSequences</span><span class="p">(</span><span class="n">num_words</span><span class="o">=</span><span class="n">vocab_size</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>Using TensorFlow backend.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Padder</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">TransformerMixin</span><span class="p">):</span>
    <span class="sd">""" Pad and crop uneven lists to the same length. </span>
<span class="sd">    Only the end of lists longernthan the maxlen attribute are</span>
<span class="sd">    kept, and lists shorter than maxlen are left-padded with zeros</span>
<span class="sd">    </span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    maxlen: int</span>
<span class="sd">        sizes of sequences after padding</span>
<span class="sd">    max_index: int</span>
<span class="sd">        maximum index known by the Padder, if a higher index is met during </span>
<span class="sd">        transform it is transformed to a 0</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="mi">500</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxlen</span> <span class="o">=</span> <span class="n">maxlen</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_index</span> <span class="o">=</span> <span class="kc">None</span>
        
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_index</span> <span class="o">=</span> <span class="n">pad_sequences</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxlen</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>
    
    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">pad_sequences</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxlen</span><span class="p">)</span>
        <span class="n">X</span><span class="p">[</span><span class="n">X</span> <span class="o">></span> <span class="bp">self</span><span class="o">.</span><span class="n">max_index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">X</span>

<span class="n">padder</span> <span class="o">=</span> <span class="n">Padder</span><span class="p">(</span><span class="n">maxlen</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="LSTM-construction-and-training">LSTM construction and training<a class="anchor-link" href="#LSTM-construction-and-training">¶</a></h3><p>We now simply have to chain our preprocessing Transformers and our LSTM model. Here I have chosen a rather standard network with 128 hidden units, and dropout rate of 50 %. I only train during 2 epochs as I don't monitor overffiting here, but a more performant model could be trained with more epochs and early stopping.</p>
<p>Note that we use a <a href="https://en.wikipedia.org/wiki/Bidirectional_recurrent_neural_networks">Bidirectional LSTM</a> here, that uses information from both preceeding and following words to compute a word representation when scanning a sentence, but this is a detail for our purpose.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="k">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Embedding</span><span class="p">,</span> <span class="n">Bidirectional</span><span class="p">,</span> <span class="n">LSTM</span>
<span class="kn">from</span> <span class="nn">keras.wrappers.scikit_learn</span> <span class="k">import</span> <span class="n">KerasClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="k">import</span> <span class="n">make_pipeline</span>

<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">max_features</span> <span class="o">=</span> <span class="n">vocab_size</span> <span class="o">+</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">create_model</span><span class="p">(</span><span class="n">max_features</span><span class="p">):</span>
    <span class="sd">""" Model creation function: returns a compiled Bidirectional LSTM"""</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Embedding</span><span class="p">(</span><span class="n">max_features</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Bidirectional</span><span class="p">(</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">recurrent_dropout</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'sigmoid'</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'adam'</span><span class="p">,</span> <span class="s1">'binary_crossentropy'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">model</span>

<span class="c1"># Use Keras Scikit-learn wrapper to instantiate a LSTM with all methods</span>
<span class="c1"># required by Scikit-learn for the last step of a Pipeline</span>
<span class="n">sklearn_lstm</span> <span class="o">=</span> <span class="n">KerasClassifier</span><span class="p">(</span><span class="n">build_fn</span><span class="o">=</span><span class="n">create_model</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> 
                               <span class="n">max_features</span><span class="o">=</span><span class="n">max_features</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Build the Scikit-learn pipeline</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">sequencer</span><span class="p">,</span> <span class="n">padder</span><span class="p">,</span> <span class="n">sklearn_lstm</span><span class="p">)</span>

<span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">texts_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/2
18750/18750 [==============================] - 259s - loss: 0.5450 - acc: 0.7294      
Epoch 2/2
18750/18750 [==============================] - 276s - loss: 0.3682 - acc: 0.8447     
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">metrics</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Computing predictions on test set...'</span><span class="p">)</span>
<span class="n">y_preds</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">texts_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Test accuracy: </span><span class="si">{:.2f}</span><span class="s1"> %'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_preds</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Computing predictions on test set...
6250/6250 [==============================] - 24s     
Test accuracy: 82.90 %
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Performances are similar to the <em>TF-IDF + Random forest</em> model of the first part of this post (82% accuracy). Hence we do not have enough data to leverage the modelling power of our LSTM, but this example is enough to illustrate the usage of LIME for a deep learning model. As before we choose an example and compute feature importance with the LIME package.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [45]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We choose a sample from test set</span>
<span class="n">idx</span> <span class="o">=</span> <span class="mi">11</span>
<span class="n">text_sample</span> <span class="o">=</span> <span class="n">texts_test</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'negative'</span><span class="p">,</span> <span class="s1">'positive'</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Sample </span><span class="si">{}</span><span class="s1">: last 80 words (only part used by the model)'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'-'</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">" "</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text_sample</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">80</span><span class="p">:]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'-'</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Probability(positive) ='</span><span class="p">,</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">([</span><span class="n">text_sample</span><span class="p">])[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'True class: </span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="n">class_names</span><span class="p">[</span><span class="n">y_test</span><span class="p">[</span><span class="n">idx</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Sample 11: last 80 words (only part used by the model)
--------------------------------------------------
Who? What? Where? When? Why? The acting was terrible. Very robotic, rehearsed. I have seen all of the actors in this film in better roles. The screenplay was very elementary. By the end of this film, the story line was tied up. And Jeane Claude LaMarre should be tied up, too. So that he never attempts to write/direct another film.
--------------------------------------------------
1/1 [==============================] - 0s
Probability(positive) = 0.112901
True class: negative
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [46]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">lime.lime_text</span> <span class="k">import</span> <span class="n">LimeTextExplainer</span>

<span class="n">explainer</span> <span class="o">=</span> <span class="n">LimeTextExplainer</span><span class="p">(</span><span class="n">class_names</span><span class="o">=</span><span class="n">class_names</span><span class="p">)</span>
<span class="n">explanation</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">explain_instance</span><span class="p">(</span><span class="n">text_sample</span><span class="p">,</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">,</span> <span class="n">num_features</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">weights</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">explanation</span><span class="o">.</span><span class="n">as_list</span><span class="p">())</span>
<span class="n">lime_weights</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'words'</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="s1">'weights'</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">values</span><span class="p">())})</span>

<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"words"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"weights"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">lime_weights</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Sample </span><span class="si">{}</span><span class="s1"> features weights given by LIME'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>5000/5000 [==============================] - 20s      128/5000 [..............................] - ETA: 19s
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
YII=
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As for the first model, we get an ensemble of 10 explanation features that seem make sense. Note the fact that "write" has a large negative weight, probably because it is preceeded by "he never attempts to" in our example (and the LSTM model is aware of the ordering of words!).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have used the LIME interpretation to provide explanations for the individual predictions of a random forest model working on TF-IDF features, and a recurrent neural network. In both cases LIME outputs important features that make sense.</p>
<p>While we were having a way to obtain weights for single predictions with the random forest, LIME could also provide a sign that allows for a deeper understanding of the model output. In the case of the reccurent neural network, LIME is even more important as it is harder than for the random forest to extract the relevant weights to determine the most important features.</p>
<p>According to my experiments, LIME appears as an interesting method to interpret a model output. Its model agnostic aspect helps to compare different models within the same framework, and may become an important tool to assess models relevance, in addition to the standard performance metrics that are sensitive to datasets (ubiquitous :) leaks from the future, or can be misleading when evaluation metrics definition is tricky.</p>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://nkthiebaut.github.io/tag/python.html">python</a>
      <a href="https://nkthiebaut.github.io/tag/machine-learning.html">machine learning</a>
      <a href="https://nkthiebaut.github.io/tag/deep-learning.html">deep learning</a>
    </p>
  </div>

<section>
    <p id="post-share-links">
        Share on:
	<span class="fa fa-twitter"></span>
        <a href="https://twitter.com/intent/tweet?text=LIME%20of%20words%20%28part%202/2%29&url=https%3A//nkthiebaut.github.io/deep-lime.html" target="_blank" title="Share on Twitter">Twitter</a>
	<span class="fa fa-facebook"></span>
        <a href="http://www.facebook.com/sharer/sharer.php?u=https%3A//nkthiebaut.github.io/deep-lime.html" target="_blank" title="Share on Facebook">Facebook</a>
        <span class="fa fa-google"></span>
        <a href="https://plus.google.com/share?url=https%3A//nkthiebaut.github.io/deep-lime.html" target="_blank" title="Share on Google Plus">Google+</a>
        <span class="fa fa-at"></span>
        <a href="mailto:?subject=LIME%20of%20words%20%28part%202/2%29&amp;body=https%3A//nkthiebaut.github.io/deep-lime.html" target="_blank" title="Share via Email">Email</a>
    </p>
</section>




</article>

    <footer>
<p>&copy; Nicolas Thiebaut </p>
<!--<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>-->    </footer>
  </main>





<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Data4thought: data science blog ",
  "url" : "https://nkthiebaut.github.io",
  "image": "https://nkthiebaut.github.io/images/PhotoThiebaut.jpg",
  "description": "Nicolas Thiebaut's data science blog"
}
</script>
</body>
</html>